<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drift Systems | Contested Environments</title>
    
    <script>
        window.MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
          },
          svg: {
            fontCache: 'global'
          }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’ </text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />

    <style>
        :root {
            /* BRAND PALETTE RESTORED */
            --bg0: #000;
            --bg1: #050505;
            --panel: rgba(0,20,40,0.5);
            --border: rgba(0,255,255,0.2);
            --border-strong: rgba(0,255,255,0.8);
            --text: #fff;
            --muted: #a0a0a0;
            --muted2: #888;
            --cyan: #00ffff;
            --mint: #00ffaa;
            --warn: #ffaa00;
            --fail: #ff4444;
            --mono: 'JetBrains Mono', ui-monospace, monospace;
            --sans: 'Inter', system-ui, sans-serif;
            --shadow: 0 0 20px rgba(0,255,255,0.10);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: var(--sans);
            background-color: var(--bg0);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Typography */
        h1, h2, h3 { font-weight: 700; letter-spacing: -0.02em; margin-bottom: 1rem; color: #fff; }
        h1 { 
            font-size: 3rem; line-height: 1.1; 
            background: linear-gradient(90deg, #fff, var(--cyan)); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        }
        h2 { 
            font-size: 1.8rem; border-left: 4px solid var(--cyan); 
            padding-left: 1rem; margin-top: 3rem; 
        }
        p { margin-bottom: 1.5rem; font-size: 1.05rem; color: var(--muted); }
        
        .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
        
        /* Navigation */
        nav { padding: 20px 0; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; }
        .logo { font-family: var(--sans); font-weight: 900; font-size: 1.2rem; letter-spacing: 1px; color: #fff; text-decoration: none; }
        .nav-links a { font-family: var(--mono); color: var(--muted); text-decoration: none; margin-left: 20px; font-size: 0.85rem; transition: color 0.2s; }
        .nav-links a:hover { color: var(--cyan); }

        /* Hero */
        .hero { padding: 80px 0; text-align: center; }
        .hero .eyebrow { color: var(--cyan); font-family: var(--mono); font-weight: 700; letter-spacing: 1px; font-size: 0.85rem; display: block; margin-bottom: 10px; }
        
        .btn { 
            display: inline-block; padding: 12px 30px; 
            background: rgba(0, 255, 255, 0.1); color: var(--cyan); 
            border: 1px solid var(--cyan); font-family: var(--mono); 
            font-size: 0.85rem; font-weight: 700; text-decoration: none; 
            transition: all 0.2s; 
        }
        .btn:hover { background: var(--cyan); color: #000; box-shadow: 0 0 20px rgba(0,255,255,0.4); }

        /* --- MESH SIMULATOR STYLES --- */
        .sim-container {
            background: var(--bg1); border: 1px solid var(--border); border-radius: 4px;
            padding: 24px; margin: 40px 0; position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        
        .sim-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 14px; }
        .status-led { width: 10px; height: 10px; border-radius: 50%; background: #333; display: inline-block; margin-right: 8px; }
        .status-led.ok { background: var(--mint); box-shadow: 0 0 8px var(--mint); }
        .status-led.warn { background: var(--warn); box-shadow: 0 0 8px var(--warn); }
        .status-led.fail { background: var(--fail); box-shadow: 0 0 8px var(--fail); }

        .nodes-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; text-align: center; }
        .node { 
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); 
            padding: 18px; border-radius: 4px; transition: border-color 0.3s; position: relative; 
        }
        .node.hq { border-color: var(--border-strong); grid-column: span 3; margin-bottom: 20px; background: rgba(0,255,255,0.02); }
        .node h4 { color: #fff; font-family: var(--mono); font-size: 0.9rem; margin-bottom: 10px; letter-spacing: 1px; }
        
        .packet-log { 
            font-family: var(--mono); font-size: 0.75rem; color: var(--muted2); 
            height: 80px; overflow-y: hidden; border-top: 1px solid rgba(255,255,255,0.1); 
            margin-top: 14px; padding-top: 8px; text-align: left;
        }
        .log-entry { margin-bottom: 3px; }
        .log-entry.rx { color: var(--mint); }
        .log-entry.tx { color: var(--cyan); }
        .log-entry.err { color: var(--fail); }

        .controls { display: flex; gap: 8px; justify-content: center; margin-top: 12px; }
        .control-btn { 
            font-family: var(--mono); font-size: 0.7rem; 
            background: transparent; border: 1px solid #444; color: #aaa; 
            padding: 6px 10px; cursor: pointer; text-transform: uppercase; 
            transition: all 0.2s;
        }
        .control-btn:hover { border-color: #fff; color: #fff; }
        .control-btn.jam:hover { border-color: var(--warn); color: var(--warn); }
        .control-btn.replay:hover { border-color: var(--fail); color: var(--fail); }
        
        .control-btn.jam.active { background: var(--warn); color: #000; border-color: var(--warn); }
        .control-btn.replay.active { background: var(--fail); color: #000; border-color: var(--fail); }

        /* --- SECTION STYLES --- */
        .grid-text { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 60px 0; }
        .feature-card { border: 1px solid var(--border); padding: 24px; background: var(--panel); transition: transform 0.2s; }
        .feature-card:hover { border-color: var(--border-strong); transform: translateY(-2px); }
        .feature-card h3 { color: var(--cyan); font-family: var(--mono); font-size: 1rem; margin-bottom: 12px; letter-spacing: 1px; }

        footer { border-top: 1px solid rgba(255,255,255,0.1); padding: 40px 0; margin-top: 80px; text-align: center; font-size: 0.9rem; color: #666; }
        
        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            .grid-text { grid-template-columns: 1fr; }
            .nodes-grid { grid-template-columns: 1fr; }
            .node.hq { grid-column: span 1; }
        }
    </style>
</head>
<body>

    <div class="container">
        <nav>
            <a href="../index.html" class="logo">DRIFT<span style="font-weight:300;">SYSTEMS</span></a>
            <div class="nav-links">
                <a href="../index.html">Home</a>
                <a href="#sim">Mesh Sim</a>
                <a href="#specs">Specs</a>
            </div>
        </nav>

        <section class="hero">
            <span class="eyebrow">CONTESTED ENVIRONMENTS</span>
            <h1>Anti-Jam Liveness &<br>Clockless Sync</h1>
            <p>Maintain mesh continuity in GPS-denied environments. Drift Systems replaces timestamp-based authentication with state-based ordering, rendering replay attacks and jamming mathematically distinguishable.</p>
            <br>
            <a href="#sim" class="btn">LAUNCH SIMULATOR</a>
        </section>

        <hr style="border: 0; border-top: 1px solid var(--border-color);">

        <section id="sim">
            <h2>1. Tactical Mesh Simulator</h2>
            <p>The simulation below demonstrates the three core invariants of the Drift Protocol: <strong>Freshness</strong> (Sequence Validity), <strong>Timing</strong> (Latency Budgets), and <strong>Quorum</strong> (Majority Rule).</p>

            <div class="sim-container">
                <div class="sim-header">
                    <div>
                        <span style="color:var(--muted); font-family:var(--mono); font-size:0.8rem; letter-spacing:1px;">PROTOCOL STATE:</span>
                        <span id="mesh-status" style="color:#fff; font-family:var(--mono); font-weight:700; margin-left:10px;">ACTIVE</span>
                    </div>
                    <div>
                        <span class="status-led ok" id="system-led"></span>
                        <span style="font-size:0.8rem; font-family:var(--mono); color:var(--mint); letter-spacing:1px;">SECURE</span>
                    </div>
                </div>

                <div class="nodes-grid">
                    <div class="node hq" id="node-hq">
                        <h4>COMMAND (HQ)</h4>
                        <div style="font-size:0.8rem; color:var(--muted2); font-family:var(--mono); margin-bottom:10px;">Seq: <span id="hq-seq">100</span></div>
                        <div class="controls">
                            <button class="control-btn" id="btn-ping" style="border-color:var(--cyan); color:var(--cyan); width:100%;">SEND CHALLENGE</button>
                        </div>
                        <div class="packet-log" id="log-hq"></div>
                    </div>

                    <div class="node" id="node-1">
                        <h4>UNIT ALPHA</h4>
                        <div class="controls">
                            <button class="control-btn jam" onclick="toggleJam(1)">JAM</button>
                            <button class="control-btn replay" onclick="triggerReplay(1)">REPLAY</button>
                        </div>
                        <div class="packet-log" id="log-1"></div>
                    </div>

                    <div class="node" id="node-2">
                        <h4>UNIT BRAVO</h4>
                        <div class="controls">
                            <button class="control-btn jam" onclick="toggleJam(2)">JAM</button>
                            <button class="control-btn replay" onclick="triggerReplay(2)">REPLAY</button>
                        </div>
                        <div class="packet-log" id="log-2"></div>
                    </div>

                    <div class="node" id="node-3">
                        <h4>UNIT CHARLIE</h4>
                        <div class="controls">
                            <button class="control-btn jam" onclick="toggleJam(3)">JAM</button>
                            <button class="control-btn replay" onclick="triggerReplay(3)">REPLAY</button>
                        </div>
                        <div class="packet-log" id="log-3"></div>
                    </div>
                </div>
            </div>
            
            <p style="font-size: 0.95rem; border-left: 2px solid var(--border); padding-left: 15px; color: var(--muted2);">
                <strong style="color:var(--text);">Instruction:</strong> Click "SEND CHALLENGE" to verify mesh health. Toggle "JAM" to introduce artificial latency (>500ms). Click "REPLAY" to inject a valid-but-stale packet. Notice how the HQ rejects Replays instantly (Bad Seq) but classifies Jamming as a "TIMEOUT".
            </p>
        </section>

        <section id="specs">
            <h2>2. Technical Capabilities</h2>
            <div class="grid-text">
                <div class="feature-card">
                    <h3>Deterministic Frequency Hopping</h3>
                    <p>Instead of relying on shared secrets or GPS time slots, nodes generate hopping patterns using the <strong>Drift Attractor</strong>. This creates a high-entropy spread spectrum that is mathematically unpredictable to adversaries but perfectly synchronized for peers.</p>
                </div>
                <div class="feature-card">
                    <h3>GPS-Denied Liveness</h3>
                    <p>Drift replaces "Wall Clock Time" with "Sequence Time." Even if the local clock drifts by seconds, the arithmetic sequence ensures packet ordering. This allows for tight authentication windows without atomic clocks.</p>
                </div>
                <div class="feature-card">
                    <h3>Anti-Replay Geometry</h3>
                    <p>Because the state evolution $S_{t+1} = F(S_t)$ is non-invertible and path-dependent, a captured packet $P_t$ cannot be used to forge $P_{t+1}$. Replaying $P_t$ fails the freshness check immediately.</p>
                </div>
                <div class="feature-card">
                    <h3>Quorum Recovery</h3>
                    <p>If a node is jammed, the mesh degrades gracefully. As demonstrated in the sim, if 2/3 nodes respond, the mesh remains "Operational" (Amber Status) rather than failing completely.</p>
                </div>
            </div>
        </section>

    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 Drift Systems Inc. <br> Systems Architect: Lukas Cain</p>
            <p style="font-size: 0.8rem; color: #444;">Export Controlled Technology (EAR99).</p>
        </div>
    </footer>

    <script>
    (function() {
        // --- CONFIG ---
        const NODES = [1, 2, 3];
        let hqSeq = 100;
        let isJamming = {1: false, 2: false, 3: false};
        let isReplaying = {1: false, 2: false, 3: false};
        let responses = [];
        let challengeTimestamp = 0;
        const TIMEOUT_MS = 600; // Protocol timeout

        // --- DOM ---
        const btnPing = document.getElementById('btn-ping');
        const hqSeqDisplay = document.getElementById('hq-seq');
        const statusLed = document.getElementById('system-led');
        const statusText = document.getElementById('mesh-status');

        function log(nodeId, type, msg) {
            const el = document.getElementById(`log-${nodeId}`);
            const span = document.createElement('div');
            span.className = `log-entry ${type}`;
            span.innerText = `> ${msg}`;
            el.insertBefore(span, el.firstChild);
            // Limit history
            if(el.children.length > 4) el.lastChild.remove();
        }

        // --- ACTIONS ---
        window.toggleJam = function(id) {
            isJamming[id] = !isJamming[id];
            const btn = document.querySelector(`#node-${id} .jam`);
            if(isJamming[id]) {
                btn.classList.add('active');
                btn.innerText = "JAMMING...";
            } else {
                btn.classList.remove('active');
                btn.innerText = "JAM";
            }
        };

        window.triggerReplay = function(id) {
            isReplaying[id] = true;
            const btn = document.querySelector(`#node-${id} .replay`);
            btn.classList.add('active');
            setTimeout(() => {
                isReplaying[id] = false;
                btn.classList.remove('active');
            }, 1500);
        };

        btnPing.onclick = async function() {
            btnPing.disabled = true;
            hqSeq++;
            hqSeqDisplay.innerText = hqSeq;
            responses = [];
            challengeTimestamp = Date.now();
            
            // 1. HQ Sends
            log('hq', 'tx', `BCAST CHALLENGE S=${hqSeq}`);
            statusText.innerText = "POLLING...";
            statusText.style.color = "#fff";
            statusLed.className = "status-led"; 
            
            // 2. Nodes Process
            const promises = NODES.map(id => processNode(id, hqSeq));
            
            await Promise.all(promises);
            
            // 3. Evaluate Quorum
            evaluateMesh();
            btnPing.disabled = false;
        };

        async function processNode(id, seq) {
            // Visualize RX
            log(id, 'rx', `RECV CHALLENGE S=${seq}`);
            
            // Simulate processing time
            let delay = 100 + Math.random() * 100;
            let responseSeq = seq; 
            let status = "OK";

            // ATTACK: Jamming
            if(isJamming[id]) {
                delay += 800; // Push beyond timeout
            }

            // ATTACK: Replay (sends old sequence)
            if(isReplaying[id]) {
                responseSeq = seq - 5; // Stale
            }

            await new Promise(r => setTimeout(r, delay));

            // Log TX from Node
            if(isJamming[id]) {
                log(id, 'err', `TX BLOCKED (LOW SNR)`);
                handleResponse(id, responseSeq, delay); 
            } else if(isReplaying[id]) {
                log(id, 'tx', `TX RESP S=${responseSeq} (STALE)`);
                handleResponse(id, responseSeq, delay);
            } else {
                log(id, 'tx', `TX RESP S=${seq} (VALID)`);
                handleResponse(id, responseSeq, delay);
            }
        }

        function handleResponse(id, seq, latency) {
            // HQ Processing Logic
            let result = "OK";
            if(latency > TIMEOUT_MS) result = "TIMEOUT";
            else if(seq !== hqSeq) result = "REPLAY_FAIL";
            
            responses.push({id, result});
            
            // Log at HQ
            if(result === "OK") log('hq', 'rx', `NODE ${id}: AUTH OK`);
            else if(result === "TIMEOUT") log('hq', 'err', `NODE ${id}: TIMEOUT (> ${TIMEOUT_MS}ms)`);
            else log('hq', 'err', `NODE ${id}: REJECT (S=${seq} != ${hqSeq})`);
        }

        function evaluateMesh() {
            let pass = 0;
            let fail = 0;
            
            responses.forEach(r => {
                if(r.result === "OK") pass++;
                else fail++;
            });

            if(pass === 3) {
                statusText.innerText = "SECURE (3/3)";
                statusText.style.color = "var(--mint)";
                statusLed.className = "status-led ok";
            } else if(pass >= 1) {
                statusText.innerText = `DEGRADED (${pass}/3)`;
                statusText.style.color = "var(--warn)";
                statusLed.className = "status-led warn";
            } else {
                statusText.innerText = "MESH LOSS";
                statusText.style.color = "var(--fail)";
                statusLed.className = "status-led fail";
            }
        }

    })();
    </script>
</body>
</html>
